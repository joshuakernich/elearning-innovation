<!DOCTYPE html>
<html>
<head>
  <title></title>
  <script type="text/javascript" src="./jquery-3.4.1.min.js"></script>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script type="text/javascript">

    var rubric = {
      name:"RUBRIC 1",
      demonstrations:[
        {name:"R1D1",actual:17,possible:20},
        {name:"R1D2",actual:25.5,possible:30},
        {name:"R1D3",actual:20,possible:20},
        {name:"R1D4",actual:0,possible:15},
        {name:"R1D5",actual:9.75,possible:15},
      ]
    }


    $(function() {


      var arc = d3.arc();

      arc({
        innerRadius: 0,
        outerRadius: 100,
        startAngle: 0,
        endAngle: Math.PI / 2
      }); // "M0,-100A100,100,0,0,1,100,0L0,0Z"

      function drawPie($svg,allTheSame){

        var total = 0;
        var demonstrations = [];

        for(var i=0; i<5; i++){
          var possible = 10 + Math.random() * 50;
          if(allTheSame) possible = 50;
          var actual = Math.random() * possible;

          total += possible;
          demonstrations[i] = {possible:possible,actual:actual}
        }

        var angle = 0;
        for(var i=0; i<demonstrations.length; i++){
          $path = $('<path class="n'+i+'">').appendTo($svg);

          if(demonstrations[i].actual/demonstrations[i].possible > 0.75) $path.addClass('good');
          else if(demonstrations[i].actual/demonstrations[i].possible > 0.5) $path.addClass('bad');
          else $path.addClass('worse');

          $path.attr('d',arc({
            innerRadius: 0,
            outerRadius: 50*demonstrations[i].actual/demonstrations[i].possible,
            startAngle: angle,
            endAngle: angle + demonstrations[i].possible/total*Math.PI*2
          }));

          angle += demonstrations[i].possible/total*Math.PI*2
        }

        $svg.html($svg.html());
      }

      function drawSeries(n){

        var acts = [];
        var aggP = 0;
        var aggA = 0;

        acts[0] = {aggPossible:0,aggActual:0};

        for(var i=0; i<10; i++){

          var act = {name: "Activity "+i,rub:[],possible:0,actual:0};

          for( var j=0; j<5; j++){
            var p = 10 + Math.random()*100;
            var a = Math.random()*p;

            if(Math.random()>0.5) a = p;

            act.rub[j] = {possible:p,actual:a}

            aggP += p;
            aggA += a;

            act.possible += p;
            act.actual += a;
          }

          act.aggPossible = aggP;
          act.aggActual = aggA;



          acts.push(act);
        }

        var scope = 4000;

        var line = d3.line()
        .x(function(d) { return d.aggPossible/scope *100; })
        .y(function(d) { return 100 - d.aggActual/scope *100; });
        

        $('<path class="actual n'+n+'">').appendTo($('.trajectory svg')).attr('d',line(acts));

        //$('path.actual').attr("d", line(acts));

        for( var i=1; i<acts.length; i++){
          var d = acts[i];

          var $act = $("<div class='act n"+n+"'>").appendTo($(".trajectory")).css({bottom:d.aggActual/scope *100 + '%', left: d.aggPossible/scope *100 + '%'});
          
          var dx = (d.aggPossible-acts[i-1].aggPossible)/aggP*700;
          var dy = (d.aggActual-acts[i-1].aggActual)/aggP*200;
          var d = Math.sqrt(dx*dx+dy*dy);
          var degs = -Math.atan2(dy,dx)*180/Math.PI;

          

          var $tail = $("<div class='tail'>").appendTo($act).css({'border-right-width':d});
          $tail.css({transform:'rotate('+degs+'deg)'})

        }
      }



      for(var i=0; i<5; i++){
          drawSeries(i);
        }

      $(".trajectory svg").html($(".trajectory svg").html());

      drawPie( $(".assignment svg"));

      function drawAssignment(name){

        var $ass = $('.assignment').eq(0).clone().appendTo($('.assignment-list'));
        $ass.find('svg').empty();
        $ass.find('h1').html(name);
        drawPie( $ass.find('svg') );

        
        
      }

      $('.modal').click(function(){
          $('.modal').hide();
        })

      drawAssignment('1.2 Explore');
      drawAssignment('1.3 Decide');
      drawAssignment('1.4 Practice');
      drawAssignment('1.5 Demonstrate');
      drawAssignment('1.6 Reflect');
      
      drawPie( $(".outcome-breakdown svg").eq(0),true);
      drawPie( $(".outcome-breakdown svg").eq(1),true);
      drawPie( $(".outcome-breakdown svg").eq(2),true);

      $('.outcome-breakdown').click(function(){
        $('.modal').show();
        $('.modal-box').hide();
        $('.modal .modal-trajectory').css({display:"inline-block"});
        $('.modal-trajectory .pie').html($(this).find('svg').html());
        $('.modal-trajectory h1').html($(this).find('h2').html());

      })

      $('.assignment').click(function(){
          $('.modal').show();
        $('.modal-box').hide();
          $('.modal-assignment').css({display:"inline-block"});
          $('.modal-assignment .pie').html($(this).find('svg').html());
          $('.modal-assignment h1').html($(this).find('h1').html());
        })

      function rubricToTable(r){
        var str = '';
        for(i in r.demonstrations){
          var d = r.demonstrations[i];
          str += '<div class="demonstration">'+d.name+'</div>';
        }
      }
    });
  </script>
  <style>
  @font-face{
    font-family: 'secondary-font';
    src: url('./amadeus/DroidSans.ttf'); 
  }

  body{
    font-family: 'secondary-font';
    color: #333;
    width: 700px;
    padding: 0px;
    margin: auto;
    padding-bottom: 50px;
  }

    h1{
      font-size: 30px;
      color: #005AB8;
      font-weight: normal
    }

    h2{
      margin-top: 0px;
      font-size: 20px;
      font-weight: normal;
      color: rgba(0, 169, 224, 1);
    }

    .trajectory{
      width: 600px;
      height: 300px;
      border-left: 1px solid #999;
      border-bottom: 1px solid #999;
      position: relative;
      margin-left: 20px;
      margin-bottom: 20px;
      margin-right: 65px;
    }

    .trajectory svg{
      position: absolute;
      top: 0px;
      left: 0px;
    }

    .trajectory .axis-label{
      position: absolute;
      font-size: 10px;
      top: 310px;
      left: 50px;
    }

    .trajectory .axis-label.y{
      width: 300px;
      left: -165px;
      top: 120px;
      transform: rotate(-90deg);
    }

    .trajectory-marker{
      position: absolute;
    }

    .assignment{
      padding: 10px;
      color: #777;
      font-size: 12px;
      display: inline-block;
      margin-right: 5px;
      margin-bottom: 5px;
      position: relative;
      text-align: center;
      cursor: pointer;
    }

    .assignment h1{
      font-size: 15px;
      color: inherit;
      margin-bottom: 0px;
    }

    .assignment h2{
      font-size: 10px;
      color: inherit;
      margin-top: 5px;
    }

    .trajectory-marker{

    }

    .r{
      font-size: 10px;
      width: 30px;
      line-height: 20px;
      background: #f5f5f5;
      border-radius: 2px;
      display: inline-block;
      text-align: center;
      font-weight: bold;
      color: #77bbff;
    }

    .pie{
      background: #eee;
      border-radius: 100px;
      box-sizing: border-box;

      vertical-align: middle;
    }

    .assignment path{
      fill: blue;
    }

    path.actual{
      stroke-width: 0.2;
      stroke: blue;
      fill: none;
    }

    path.possible{
      fill: rgba(200,255,200);
    }

    path.bad{
      fill: rgba(255,230,200);
    }

    path.worse{
      fill: rgba(255,200,200);
    }

    .label{
      position: absolute;
      right: -205px;
      width: 200px;

      font-size: 10px;
      display: inline-block;
    }

    .act{
      position: absolute;
    }

    .act:after{
      content: "";
      width: 8px;
      height: 8px;
      border-radius: 10px;
      background: white;
      position: absolute;
      left: -4px;
      top: -4px;
      box-sizing: border-box;
      border: 2px solid blue;
    }

    .act .tail{
      width: 0; 
      height: 0; 
      border-top: 2px solid transparent;
      border-bottom: 2px solid transparent; 
      border-right:100px solid blue;
      position: absolute;
      top: -1px;
      right: 0px; 
      transform-origin: 100% 50%;
      display: none;
    }

    h1 img{
      vertical-align: middle;
      margin-right: 15px;
    }

    select, option{
      font-size: inherit;
      font-family: inherit;
      color: inherit;
      background: #eee;
      border: none;
    }

    .outcome-breakdown {
      display: inline-block;
      text-align: center;
      margin-right: 5px;
      background: white;
      padding: 10px;
      cursor: pointer;
      color: #777;
    }

    .outcome-breakdown:after, .assignment:after{
      content: "more...";
      margin-top: 5px;
      display: block;
      font-size: 10px;
      color: blue;
    }

    .outcome-breakdown h2{
      font-size: 15px;
      color: inherit;
      width: 100px;
    }

    .assignment-popup{
      position: absolute;
      left: 100%;
      top: 0px;
      padding: 10px;
      border: 1px solid #ddd;
      background: white;
      z-index: 1;
      display: inline-block;
      display: none;
    }



    .assignment button{
      position: absolute;
      right: 5px;
      top: 5px;
    }

    .assignment.open .assignment-popup{
      display: block;
    }

    .outcome-breakdown path{

    }


    path.good{ fill: rgb(0,163,78); }
    path.bad{ fill: rgb(247,168,39); }
    path.worse{ fill: rgb(206,0,88); }

    .trajectory path.actual{ stroke: #333;  }
    .act:after{ border-color: #333; }

    .keys{
      display: inline-block;
      font-size: 10px;
      color: #777;
      margin-left: 20px;
    }

    .key{
      display: inline-block;
      margin-right: 10px;
    }

    .key:before{
      content: "";
      width: 10px;
      height: 10px;
      display: inline-block;
      vertical-align: middle;
      margin-right: 3px;
      border-radius: 5px;
    }

    .key:nth-of-type(1):before{ background: rgb(0,163,78); }
    .key:nth-of-type(2):before{ background: rgb(247,168,39); }
    .key:nth-of-type(3):before{ background: rgb(206,0,88); }

    .outcome{
      font-size: 12px;
      padding: 2px 10px;
    }

    .outcome:before{
      content: "";
      width: 10px;
      height: 10px;
      display: inline-block;
      vertical-align: middle;
      margin-right: 3px;
      border-radius: 5px;
    }

    .outcome-writeup .actual.good{
      background: rgb(0,163,78);
    }

    .outcome-writeup .actual.bad{
      background: rgb(247,168,39);
    }

    .outcome-writeup .actual.worse{
      background: rgb(206,0,88);
    }

    .outcome.good:before{
      background: rgb(0,163,78);
    }

    .outcome.bad:before{
      background: rgb(247,168,39);
    }

    .outcome.worse:before{
      background: rgb(206,0,88);
    }

    .outcomes{
      display: inline-block;
      vertical-align: middle;
    }

    .modal{
      position: fixed;
      top: 0px;
      left: 0px;
      right: 0px;
      bottom: 0px;
      background: rgba(240,240,240,0.9);
      text-align: center;
      padding: 20px;
      display: none;
    }

    .modal-box{
      background: white;
      padding: 20px;
      border: 1px solid #ddd;
      margin: auto;
      display: inline-block;
      text-align: left;
      display: none;
    }

    .outcome-writeup{
      font-size: 12px;
      position: relative;
      line-height: 18px;
      margin-bottom: 2px;
    }

    .outcome-writeup .actual{

      background: #999;
      font-weight: bold;
      display: inline-block;
      text-align: center;
      margin-left: 5px;
      width: 40px;
      position: absolute;
      right: 35px;
      color: white;
      border-radius: 2px;
    }

    .outcome-writeup .possible{

      text-align: left;
      color: #999;
      font-weight: bold;
      display: inline-block;
      position: absolute;
      right: 0px;
      width: 30px;
      border-radius: 2px;
    }

    .outcome-writeup .possible:before{
      content: " / ";
    }

    .outcome-writeup .actual:before{
      content: "+ "
    }


    .modal h1{
      margin-top: 0px;
    }
    

  </style>
</head>
<body>
  <h1><img width=150 src="https://amadeus-moodle.elearninginnovation.com/pluginfile.php/1/core_admin/logocompact/0x70/1557940425/logo-amadeus.png"/>Reports for Joshua Kernich</h1>
  <h2>Outcomes <div class="keys"><div class="key">Competent</div><div class="key">Struggling</div><div class="key">Failing</div></div></h2>
  <div class='outcome-breakdown'>
    <h2>Learning Objectives</h2>
    <svg class='pie' width=100 height=100 viewbox='-50 -50 100 100'></svg>
  </div>
  <div class='outcome-breakdown'>
    <h2>Course Outcomes</h2>
    <svg class='pie' width=100 height=100 viewbox='-50 -50 100 100'></svg>
  </div>
  <div class='outcome-breakdown'>
    <h2>Program Outcomes</h2>
    <svg class='pie' width=100 height=100 viewbox='-50 -50 100 100'></svg>
  </div>
  <br><br>
  <h2>Assignments <div class="keys"><div class="key">Competent</div><div class="key">Marginal</div><div class="key">Insufficient</div></div></h2>
  <div class='assignment-list'>
  <div class='assignment'>
    <h1>1.1 Reflect</h1>
    <div class='demonstrations'>
      <h2>Rubric Demonstrations</h2>
      <svg class='pie' width=100 height=100 viewbox='-50 -50 100 100'></svg>
    </div>

    <div class='assignment-popup'>
    <div class='learning-objectives'>
      <h2>Learning Objectives</h2>
    <div class='r good'>+6</div>
    <div class='r good'>+5</div>
    <div class='r'>+4</div>
    <div class='r bad'>0</div>
    <div class='r'>+2</div>
    </div>
    <div class='course-outcomes'>
      <h2>Course Outcomes</h2>
    <div class='r good'>+5</div>
    <div class='r good'>+3</div>
    <div class='r'>+1</div>
    <div class='r bad'>0</div>
    <div class='r'>+1</div>
    </div>
    <div class='program-outcomes'>
      <h2>Program Outcomes</h2>
    <div class='r good'>+5</div>
    <div class='r'>+1</div>
    <div class='r bad'>+1</div>
    <div class='r'>0</div>
    <div class='r'>0</div>
    </div></div></div></div>
  <br>

  <div class='modal'>
    <div class='modal-box modal-assignment'>
      <h1></h1>
      <h2>Rubric Demonstrations <div class="keys"><div class="key">Competent</div><div class="key">Marginal</div><div class="key">Insufficient</div></div></h2>
      <svg class='pie' width=100 height=100 viewbox='-50 -50 100 100'></svg>
      <div class='outcomes'>
        <div class='outcome good'>This is a rubric demonstration</div>
        <div class='outcome worse'>This is a rubric demonstration</div>
        <div class='outcome good'>This is a rubric demonstration</div>
        <div class='outcome bad'>This is a rubric demonstration</div>
        <div class='outcome worse'>This is a rubric demonstration</div>
      </div>
      <br><br>
        <h2>Effect on Learning Objectives</h2>
        <div class='outcome-writeup'>This is a Learning Outcome<div class='actual good'>5</div><div class='possible'>6</div></div>
        <div class='outcome-writeup'>This is a Learning Outcome<div class='actual bad'>1</div><div class='possible'>2</div></div>
        
      <br><h2>Effect on Course Outcomes</h2>
        <div class='outcome-writeup'>This is a Course Outcome<div class='actual good'>2.6</div><div class='possible'>3</div></div>
        <div class='outcome-writeup'>This is a Course Outcome<div class='actual worse'>0</div><div class='possible'>3</div></div>
        
      <br><h2>Effect on Program Outcomes</h2>
        <div class='outcome-writeup'>This is a Program Outcome<div class='actual good'>3.7</div><div class='possible'>4</div></div>
        <div class='outcome-writeup'>This is a Program Outcome<div class='actual bad'>1</div><div class='possible'>2</div></div>
      </div>

    <div class='modal-box modal-trajectory'>
      <h1></h1>
      <h2>Breakdown <div class="keys"><div class="key">Competent</div><div class="key">Struggling</div><div class="key">Failing</div></div></h2>
      <svg class='pie' width=100 height=100 viewbox='-50 -50 100 100'></svg>
      <div class='outcomes'>
      <div class='outcome good'>This is an outcome</div>
      <div class='outcome worse'>This is an outcome</div>
      <div class='outcome good'>This is an outcome</div>
      <div class='outcome bad'>This is an outcome</div>
      <div class='outcome worse'>This is an outcome</div>
    </div>
    <br><br>
  <h2>Trajectory</h2>
  <div class='trajectory'>
    <div class='axis-label x'>Potential Competency (based on selection of assignments undertaken)</div>
    <div class='axis-label y'>Aggregate Competency (based on assignment results)</div>
    <svg vector-effect='non-scaling-stroke' width='100%' height='100%' viewbox='0 0 100 100' preserveAspectRatio='none'>
      <path class='good' d='M0,100 L100,0 L100,100'></path>
      <path class='bad' d='M0,100 L100,25, L100,100'></path>
      <path class='worse' d='M0,100 L100,50, L100,100'></path>
      <path class='actual'></path>
    </svg>
    <div class='label' style='top:0px;line-height:75px'>Competent</div>
    <div class='label' style='top:75px;line-height:75px'>Struggling</div>
    <div class='label' style='top:150px;line-height:150px'>Failing</div>
    
  </div>
</div>
</div>
</body>
</html>